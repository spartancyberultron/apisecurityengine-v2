const mongoose = require('mongoose');

const activeScanVulnerabilitySchema = new mongoose.Schema({
 
  activeScan: { 
        type: mongoose.Schema.Types.ObjectId,
        ref: 'ActiveScan',
  },
  vulnerability: { 
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Vulnerability',
  },  
  endpoint: { 
    type: mongoose.Schema.Types.ObjectId,
    ref: 'ApiEndpoint',
  },  
  description:{
    type: String, 
  },  
  riskAcceptance:{
    type: String, 
  },
  riskAcceptanceReason:{
    type: String, 
  },
  findings:{
    type: [String], 
  },
  sslFindings:{
    type: [Object], 
  },
  additionalCWEs:{
    type: [String], 
  }
},{
  timestamps: true,
});

const ActiveScanVulnerability = mongoose.model('ActiveScanVulnerability', activeScanVulnerabilitySchema);

module.exports = ActiveScanVulnerability;


