const mongoose = require('mongoose');

const attackSurfaceScanVulnerabilitySchema = new mongoose.Schema({
 
  attackSurfaceScan: { 
        type: mongoose.Schema.Types.ObjectId,
        ref: 'AttackSurfaceScan',
  },
  vulnerability: { 
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Vulnerability',
  },  
  endpoint: { 
    type: mongoose.Schema.Types.ObjectId,
    ref: 'AttackSurfaceEndpoint',
  },  
  description:{
    type: String, 
  },
  riskAcceptance:{
    type: String, 
  },
  riskAcceptanceReason:{
    type: String, 
  },
  findings:{
    type: [String], 
  },
  sslFindings:{
    type: [Object], 
  },
  additionalCWEs:{
    type: [String], 
  }
},{
  timestamps: true,
});

const AttackSurfaceScanVulnerability = mongoose.model('AttackSurfaceScanVulnerability', attackSurfaceScanVulnerabilitySchema);

module.exports = AttackSurfaceScanVulnerability;


